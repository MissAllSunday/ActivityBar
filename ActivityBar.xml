<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">

<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
	<id>Suki:ActivityBar</id>
	<version>1.2</version>

	<file name="$sourcedir/Display.php">
		<operation>
			<search position="replace"><![CDATA[// Is this user the message author?]]></search>
			<add><![CDATA[
	// ActivityBar mod
	if (ActivityBar::getInstance()->setting('enable') && ActivityBar::getInstance()->setting('show_in_posts'))
	{
		$output['member']['custom_fields']['-1'] = ActivityBar::getInstance()->activityDisplay($output);
		ksort($output['member']['custom_fields']);
	}
	// ActivityBar mod end

	// Is this user the message author?]]></add>
		</operation>
	</file>

	<file name="$sourcedir/Profile-View.php">
		<operation>
			<search position="before"><![CDATA[	$context['can_view_warning'] = in_array('w', $context['admin_features']) && (allowedTo('issue_warning') && !$context['user']['is_owner']) || (!empty($modSettings['warning_show']) && ($modSettings['warning_show'] > 1 || $context['user']['is_owner']));]]></search>
			<add><![CDATA[$context['ActivityBar'] = ActivityBar::getInstance()->activity($memID);]]></add>
		</operation>
	</file>
</modification>
